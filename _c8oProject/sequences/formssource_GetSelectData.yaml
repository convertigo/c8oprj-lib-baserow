accessibility: Hidden
comment: |
  '{
      "en": {
          "displayName": "Get Data",
          "comment": "Get data from the no-code database table. You will be able to choose the columns for the names to be displayed in the select dropdown list and the column for the values of each name."
      },
      "fr": {
          "displayName": "Récupérer les données",
          "comment": "Récupérez des données à partir d''une table no-code database. Vous pourrez choisir les colonnes pour les noms à afficher dans la liste déroulante et la colonne pour les valeurs de chaque nom."
      },
      "es": {
          "displayName": "Obtener datos",
          "comment": "Obtener datos de una tabla de no-code database. Podrá elegir las columnas para que los nombres se muestren en la lista desplegable y la columna para los valores de cada nombre."
      },
      "it": {
          "displayName": "Ottenere dati",
          "comment": "Ottieni dati da una tabella dil no-code database. Sarai in grado di scegliere le colonne per i nomi da visualizzare nel menu a discesa e la colonna per i valori di ogni nome."
      },
      "types": ["select", "checkbox", "radio", "checkbox_group", "radio_group"]
  }'
↓Call_Sequence2 [steps.SequenceStep-1729157633820]: 
  sourceSequence: lib_BaseRow.formscommon_CheckConfig
  ↓forms_config [variables.StepVariable-1729157633823]: 
    description: configure=lib_BaseRow/DisplayObjects/mobile/BrowseTables
    required: true
↓IfError [steps.IfExistStep-1729157633826]: 
  condition: IfError
  sourceDefinition: 
    - xmlizable: 
      - ↑classname: com.twinsoft.convertigo.beans.common.XMLVector
      - com.twinsoft.convertigo.beans.common.XMLVector: 
        - java.lang.String: 
          - ↑value: 1729157633820
        - java.lang.String: 
          - ↑value: ./document/error
  ↓Copy [steps.XMLCopyStep-1729157633829]: 
    sourceDefinition: 
      - xmlizable: 
        - ↑classname: com.twinsoft.convertigo.beans.common.XMLVector
        - com.twinsoft.convertigo.beans.common.XMLVector: 
          - java.lang.String: 
            - ↑value: 1729157633820
          - java.lang.String: 
            - ↑value: ./document/error
  ↓Return [steps.ReturnStep-1729157633832]: 
↓ParseConfig [steps.SimpleStep-1666717197201]: 
  expression: |
    'jConfig = JSON.parse(forms_config);
    table_id = jConfig.table_id;
    view_id = jConfig.view_id ? jConfig.view_id : null;
    let describeStructure = false;
    
    // For each column provider in the configuration, compute the lits of fields we wloud like to retriev
    // With the BaseRow API.
    if (jConfig.columns) {
    	include_fields = "";
    	jConfig.columns.forEach(col => include_fields += col + ",")
    	include_fields = include_fields.substring(0, include_fields.lastIndexOf('',''));
    }
    
    var displayValue = jConfig.displayValue != undefined ? jConfig.displayValue: jConfig.column;
    var value = jConfig.value != undefined ? jConfig.value : jConfig.line;
    
    filterExpression = forms_Filter;					// This is the Constructed Fiter API for baserow.
    
    order_by = forms_tableSort
    
    if (model == "true") {
    	log.warn("Forms Model True")
    	size = "1";
    	filterExpression = null;
    	describeStructure = true;
    	order_by = null;
    }
    
    
    '
↓Input_variables [steps.InputVariablesStep-1666100090915]: 
↓Call_Sequence1 [steps.SequenceStep-1666717386561]: 
  sourceSequence: lib_BaseRow.TableGetData
  ↓exclude [variables.StepVariable-1666717386564]: 
    comment: 'All the fields are included in the response by default. You can select a subset of fields by providing the exclude query parameter. If you for example provide the following GET parameter `exclude=field_1,field_2` then the fields with id `1` and id `2` are going to be excluded from the selection and response. If the `user_field_names` parameter is provided then instead exclude should be a comma separated list of the actual field names. For field names with commas you should surround the name with quotes like so: `exclude=My Field,"Field With , "`. A backslash can be used to escape field names which contain double quotes like so: `exclude=My Field,Field with \"`.'
    description: exclude
  ↓include_fields [variables.StepVariable-1666717386567]: 
    comment: 'All the fields are included in the response by default. You can select a subset of fields by providing the include query parameter. If you for example provide the following GET parameter `include=field_1,field_2` then only the fields withid `1` and id `2` are going to be selected and included in the response. If the `user_field_names` parameter is provided then instead include should be a comma separated list of the actual field names. For field names with commas you should surround the name with quotes like so: `include=My Field,"Field With , "`. A backslash can be used to escape field names which contain double quotes like so: `include=My Field,Field with \"`.'
    description: include
  ↓order_by [variables.StepVariable-1666717386570]: 
    comment: 'Optionally the rows can be ordered by provided field ids separated by comma. By default a field is ordered in ascending (A-Z) order, but by prepending the field with a ''-'' it can be ordered descending (Z-A). If the `user_field_names` parameter is provided then instead order_by should be a comma separated list of the actual field names. For field names with commas you should surround the name with quotes like so: `order_by=My Field,"Field With , "`. A backslash can be used to escape field names which contain double quotes like so: `order_by=My Field,Field with \"`.'
    description: order_by
  ↓page [variables.StepVariable-1666717386573]: 
    comment: Defines which page of rows should be returned.
    description: page
  ↓search [variables.StepVariable-1666717386576]: 
    comment: If provided only rows with data that matches the search query are going to be returned.
    description: search
  ↓size [variables.StepVariable-1666717386579]: 
    comment: Defines how many rows should be returned per page.
    description: size
  ↓table_id [variables.StepVariable-1666717386582]: 
    comment: Returns the rows of the table related to the provided value.
    description: table_id
    required: true
  ↓view_id [variables.StepVariable-1666717386585]: 
    comment: Includes all the filters and sorts of the provided view.
    description: view_id
  ↓filterExpression [variables.StepVariable-1666717386588]: 
  ↓describeStructure [variables.StepVariable-1680699118688]: 
↓IfExist [steps.IfExistStep-1666100090951]: 
  sourceDefinition: 
    - xmlizable: 
      - ↑classname: com.twinsoft.convertigo.beans.common.XMLVector
      - com.twinsoft.convertigo.beans.common.XMLVector: 
        - java.lang.String: 
          - ↑value: 1666717386561
        - java.lang.String: 
          - ↑value: ./document/error
  ↓Error_structure [steps.XMLErrorStep-1666100090954]: 
  ↓Return [steps.ReturnStep-1666100090957]: 
↓myVariable1 [steps.JsonSourceStep-1680712167643]: 
  sourceDefinition: 
    - xmlizable: 
      - ↑classname: com.twinsoft.convertigo.beans.common.XMLVector
      - com.twinsoft.convertigo.beans.common.XMLVector: 
        - java.lang.String: 
          - ↑value: 1666717386561
        - java.lang.String: 
          - ↑value: ./document/results
  variableName: res
↓myVariable [steps.JsonSourceStep-1680699208395]: 
  sourceDefinition: 
    - xmlizable: 
      - ↑classname: com.twinsoft.convertigo.beans.common.XMLVector
      - com.twinsoft.convertigo.beans.common.XMLVector: 
        - java.lang.String: 
          - ↑value: 1666717386561
        - java.lang.String: 
          - ↑value: ./document/structure/object
  variableName: structure
↓computeValue [steps.SimpleStep-1680712348539]: 
  expression: |
    'include("js/utils.js");
    if ("res" in this) {
    	if (!(Array.isArray(res))) {
    		res = [res];
    	}
    	if (jConfig.displayValue) {
    		res = res
    				.filter((x)=>{
    					try{
    						if((forms_filter == undefined || forms_filter == "") || (x[displayValue].toLowerCase().indexOf(forms_filter.toLowerCase()) != -1)){
    							return true
    						}
    					}
    					catch(e){
    						
    					}
    					return false;
    				})
    				.map((x) => {
    					return {
    						displayValue: base_html + computeAnyType(x[displayValue] != null ? x[displayValue] : "").innerHtml,
    						value: computeAnyType(x[value] != null ? x[value] : "").value,
    						type: "html"
    				}
    		})
    	}
    	else if (jConfig.column) {
    		res = res.map((x) => {
    			return {
    				column: x[displayValue],
    				line: x[value]
    			}
    		})
    
    	}
    	else {
    		res = [];
    	}
    }
↓object [steps.JsonToXmlStep-1680712764673]: 
  jsonObject: 
    - xmlizable: 
      - ↑classname: com.twinsoft.convertigo.beans.steps.SmartType
      - SmartType: 
        - ↑mode: JS
        - →→: res
  key: 
    - xmlizable: 
      - ↑classname: com.twinsoft.convertigo.beans.steps.SmartType
      - SmartType: 
        - ↑mode: PLAIN
        - →→: value
↓jIf [steps.IfStep-1680699398785]: 
  condition: model == "true" && "structure" in this
  ↓Sequence_JS [steps.SimpleStep-1680699255296]: 
    expression: |
      'include("js/utils.js");
      include("js/getFilter.js");
      var data = [{}];
      if("structure" in this){
      	if(!Array.isArray(structure)){
      		structure = [structure];
      	}
      
      	structure.forEach((e)=>{
      		if(jConfig.columns.indexOf(e.name) != -1){
      			e.filterHide = false;
      			// if target is formula use it''s formula_type
      			var cTarget = structure.filter((x) => {
      				return x.name == e.name
      			})[0];
      			var result = getBrFilterType(cTarget)
      			// if target is formula use it''s formula_type
      			var cType = result.type;
      			cTargetCompletion = result.value
      			cHideFromFiltering = false;
      			if (cTargetCompletion == undefined) {
      				cTargetCompletion = [];
      				cHideFromFiltering = true;
      			}
      			if (cTarget != null && cTarget.type == "single_select" && e.value == null) {
      				e.value = {
      					"id": 0,
      					"value": "",
      					"color": ""
      				}
      			}
      			e["filterCompletion"] = cTargetCompletion;
      			e["filterHide"] = cHideFromFiltering;
      			e["sortHide"] = cHideFromFiltering || cType == "file" || cType == "link_row" || (cTarget != undefined && cTarget.array_formula_type == "multiple_select");
      			data[0][e.name] = e;
      		}
      	})
      }
      
      	'
  ↓data [steps.JsonToXmlStep-1680699661741]: 
    jsonObject: 
      - xmlizable: 
        - ↑classname: com.twinsoft.convertigo.beans.steps.SmartType
        - SmartType: 
          - ↑mode: JS
          - →→: data
    key: 
      - xmlizable: 
        - ↑classname: com.twinsoft.convertigo.beans.steps.SmartType
        - SmartType: 
          - ↑mode: PLAIN
          - →→: data
↓forms_filter [variables.RequestableVariable-1666100091071]: 
  comment: |
    Filters
    
  description: 
  required: true
  value: 
↓forms_config [variables.RequestableVariable-1666100091062]: 
  comment: |
    '{
    	"en": {
            "comment": "Choose a table",
            "displayName": "Configuration"
        },
        "fr": {
            "comment": "Choisissez une table",
    		"displayName":"Configuration"
        },
        "es": {
            "comment": "Elija una tabla",
            "displayName": "Configuración"
        },
        "it": {
            "comment": "Scegli una tabella",
            "displayName": "Configurazione"
    	}
    }'
  description: configure=lib_BaseRow/DisplayObjects/mobile/BrowseTables/select
  required: true
  value: 
↓forms_Filter [variables.RequestableVariable-1680171408883]: 
  comment: |
    '{
        "en": {
            "comment": "Define a filter to apply to a table",
            "displayName": "Filter"
        },
        "fr": {
            "comment": "Définir un filtre à appliquer à la table",
            "displayName": "Filtre"
        },
        "es": {
            "comment": "Definir un filtro para aplicar a la tabla",
            "displayName": "Filtro"
        },
        "it": {
            "comment": "Definire un filtro da applicare alla tabella",
            "displayName": "Filtro"
        }
    }'
  description: filter
  required: true
  value: 
↓model [variables.RequestableVariable-1680688774991]: 
  comment: If true, just return one line of data so that No Code studio can compte the table model
↓forms_tableSort [variables.RequestableVariable-1758530362488]: 
  comment: |
    '{
        "en": {
            "comment": "Define a sort order to apply to a table",
            "displayName": "Sort"
        },
        "fr": {
            "comment": "Définir un ordre de tri à appliquer à la table",
            "displayName": "Tri"
        },
        "es": {
            "comment": "Definir un orden de clasificación para aplicar a la tabla",
            "displayName": "Ordenar"
        },
        "it": {
            "comment": "Definire un ordine di ordinamento da applicare alla tabella",
            "displayName": "Ordina"
        }
    }
    '
  description: sort
↓TestWithFilter [core.TestCase]: 
  ↓forms_config [variables.TestCaseVariable-1666717673009]: 
    comment: The Table ID you want to get data from
    description: configure=lib_BaseRow/DisplayObjects/mobile/selecttable
    required: true
    value: |
      '{
      	"table_id": "77",
      	"columns": ["Number"]
      }
      '
  ↓forms_tableFilter [variables.TestCaseVariable-1666717686496]: 
    description: 
    required: true
    value: 100
↓TestWithLinkedFileds [core.TestCase]: 
  ↓forms_config [variables.TestCaseVariable-1680180805970]: 
    comment: The Table ID you want to get data from
    description: configure=lib_BaseRow/DisplayObjects/mobile/selecttable
    required: true
    value: |
      '{
      	"table_id": "661",
      	"columns": ["Code", "Customer name"]
      }
      '
↓TestWithLinkedFiledsAndOneCol [core.TestCase]: 
  ↓forms_config [variables.TestCaseVariable-1680187153247]: 
    comment: The Table ID you want to get data from
    description: configure=lib_BaseRow/DisplayObjects/mobile/selecttable
    required: true
    value: |
      '{
      	"table_id": "661",
      	"columns": ["Customer name"]
      }
      '
↓TestWithNoFilter [core.TestCase]: 
  ↓forms_config [variables.TestCaseVariable-1680173707703]: 
    comment: The Table ID you want to get data from
    description: configure=lib_BaseRow/DisplayObjects/mobile/selecttable
    required: true
    value: |
      '{
      	"table_id": "660",
      	"columns": ["Number"]
      }
      '
↓TestWithNoFilterWith2Cols [core.TestCase]: 
  ↓forms_config [variables.TestCaseVariable-1680173777993]: 
    comment: The Table ID you want to get data from
    description: configure=lib_BaseRow/DisplayObjects/mobile/selecttable
    required: true
    value: |
      '{
      	"table_id": "660",
      	"columns": ["Number", "Accommodates"]
      }
      '
↓TestWithNoFilterWithCustomFilter [core.TestCase]: 
  ↓forms_config [variables.TestCaseVariable-1680174266714]: 
    comment: The Table ID you want to get data from
    description: configure=lib_BaseRow/DisplayObjects/mobile/selecttable
    required: true
    value: |
      '{
      	"table_id": "660",
      	"columns": ["Number", "Accommodates"]
      }
      '
  ↓forms_tableFilter [variables.TestCaseVariable-1680174292982]: 
    description: 
    required: true
    value: 
  ↓forms_Filter [variables.TestCaseVariable-1680174292984]: 
    description: 
    required: true
    value: |
      '{
      	"mode": "AND",  
      	"filters": [
      		{
      			"field": "Number",  
      			"op": "contains",	
      			"value": "100"	
      		}
      	]
      }
      '